---
tags:
  - SpringBoot
  - SpringSecurity
  - Vue
---
## 环境搭建

### 前端环境搭建

#### 创建项目

>[!tip]
> 确保你安装了最新版本的 [Node.js](https://nodejs.org/)

Vue3 [快速上手 | Vue.js](https://cn.vuejs.org/guide/quick-start.html)，在命令行中运行以下命令开始创建项目：

```
npm create vue@latest
```

这一指令将会安装并执行 [create-vue](https://github.com/vuejs/create-vue)，它是 Vue 官方的项目脚手架工具。你将会看到一些诸如 TypeScript 和测试支持之类的可选功能提示：<br /> ![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311191551312.png)

如果不确定是否要开启某个功能，可以直接按下回车键选择 `No`。在项目被创建后，通过以下步骤安装依赖并启动开发服务器：

```
cd <your-project-name>
npm install
npm run dev
```

此时 Vue 项目就应该运行起来了！<br /> ![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311191550170.png)

#### 插件安装与配置

[Visual Studio Code](https://code.visualstudio.com/) 推荐安装如下插件：[TypeScript Vue Plugin (Volar)](https://marketplace.visualstudio.com/items?itemName=Vue.vscode-typescript-vue-plugin)、[Vue Language Features (Volar)](https://marketplace.visualstudio.com/items?itemName=Vue.volar) 、[ESLint](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)，

1. 启用 ESLint 作为格式化器；<br />![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311191629056.png)
2. 设置在保存时自动进行格式化；<br />![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311191633843.png)
3. 在项目的 `.eslintrc.cjs` 文件中添加 <mark style="background: #FFB8EBA6;">rules</mark> 规则配置；

   ```js
   /* eslint-env node */
   require('@rushstack/eslint-patch/modern-module-resolution')
   
   module.exports = {
     root: true,
     extends: [
       'plugin:vue/vue3-essential',
       'eslint:recommended',
       '@vue/eslint-config-typescript',
       '@vue/eslint-config-prettier/skip-formatting'
     ],
     parserOptions: {
       ecmaVersion: 'latest'
     },
     rules: {
       'prettier/prettier': [
         'error',
         {
           semi: false,
           singleQuote: true,
           wrapAttributes: false,
           printWidth: 100,
           endOfLine: 'auto'
         }
       ]
     }
   }
   ```

#### ElementPlus 按需自动导入

使用如下命令安装 ElementPlus；参考自 [安装 | Element Plus](https://element-plus.org/zh-CN/guide/installation.html#%E4%BD%BF%E7%94%A8%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8)

```
npm install element-plus --save
```

如果想实现按需导入，需要安装额外的插件 `unplugin-vue-components` 和 `unplugin-auto-import` 来导入要使用的组件；参考自 [快速开始 | Element Plus](https://element-plus.org/zh-CN/guide/quickstart.html#%E6%8C%89%E9%9C%80%E5%AF%BC%E5%85%A5)

```
npm install -D unplugin-vue-components unplugin-auto-import
```

然后在 `vite.config.ts` 配置文件中添加如下配置信息：

```ts
import AutoImport from 'unplugin-auto-import/vite'
import Components from 'unplugin-vue-components/vite'
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers'

export default defineConfig({
  // ...
  plugins: [
    // ...
    AutoImport({
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      resolvers: [ElementPlusResolver()],
    }),
  ],
})
```

在 `App.vue` 文件中添加如下代码：

- script 部分：

  ```typescript
  const handleClick = () => {
    ElMessage.success('按需导入成功啦~')
  }
  ```

- template 部分：

  ```html
  <el-button type="primary" @click="handleClick">点击</el-button>
  ```

使用 `npm run dev` 命令运行项目，效果如下所示：<br />![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311191749142.png)

##### 解决 TypeScript 报错

即使不使用 import 导入相关组件也可正常使用！不过在 ElMessage 处报红色波浪线，提示找不到名称！<br /> ![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311191753588.png)

那么该如何解决这个问题呢？其实很简单，在 `tsconfig.app.json` 配置文件的 `include` 部分添加 `auto-imports.d.ts` 和 `components.d.ts` 文件（这两个文件作为 ElementPlus 按需导入组件的 ts 文件），如下所示，配置完成之后可以发现 ElMessage 处不再报红色波浪线！

```json
{
  "extends": "@vue/tsconfig/tsconfig.dom.json",
  "include": [
    "env.d.ts",
    "src/**/*",
    "src/**/*.vue",
    "auto-imports.d.ts",
    "components.d.ts"
  ],
  "exclude": [
    "src/**/__tests__/*"
  ],
  "compilerOptions": {
    "composite": true,
    "baseUrl": ".",
    "paths": {
      "@/*": [
        "./src/*"
      ]
    }
  }
}
```

##### 解决 ESLint 报错

如果你遇到无 undef 的 ESLint 错误时，解决方案如下所示：参考自 [GitHub - unplugin/unplugin-auto-import: Auto import APIs on-demand for Vite, Webpack and Rollup](https://github.com/unplugin/unplugin-auto-import#eslint)

> 💡 When using TypeScript, we recommend to **disable** `no-undef` rule directly as TypeScript already check for them and you don't need to worry about this.

1. 启用 `eslintrc.enabled`，在 `vite.config.ts` 配置文件的 `AutoImport` 部分添加 `eslintrc: { enabled: true }` 配置项，如下所示：

   ```typescript
   export default defineConfig({
     // ...
     plugins: [
       // ...
       AutoImport({
         resolvers: [ElementPlusResolver()], // 自动导入 ElementPlus 相关函数，如 ElMessage, ElMessageBox... (带样式)
         eslintrc: { enabled: true } // eslint 会报 no-undef 错误，添加此项会生成 .eslintrc-auto-import.json 文件
       }),
       Components({
         resolvers: [ElementPlusResolver()], // 自动导入 ElementPlus 组件，图标组件
       }),
     ],
   })
   ```

2. 经过上面一步，会生成一个 `.eslintrc-auto-import.json` 文件，将该文件配置到 `.eslintrc.cjs` 文件的 `extends` 部分中，如下所示：

   ```javascript
   /* eslint-env node */
   require('@rushstack/eslint-patch/modern-module-resolution')
   
   module.exports = {
     root: true,
     extends: [
       'plugin:vue/vue3-essential',
       'eslint:recommended',
       '@vue/eslint-config-typescript',
       '@vue/eslint-config-prettier/skip-formatting',
       '.eslintrc-auto-import.json'
     ],
     parserOptions: {
       ecmaVersion: 'latest'
     },
     rules: {
       'prettier/prettier': [
         'error',
         {
           semi: false,
           singleQuote: true,
           wrapAttributes: false,
           printWidth: 100,
           endOfLine: 'auto'
         }
       ]
     }
   }
   ```

---

> [!tip] 自动导入 Vue 相关函数，如：ref, reactive, toRef 等
> 在 `vite.config.ts` 配置文件的 `AutoImport` 部分添加 `imports: ['vue']` 配置项，如下所示：参考自 [GitHub - unplugin/unplugin-auto-import: Auto import APIs on-demand for Vite, Webpack and Rollup](https://github.com/unplugin/unplugin-auto-import#configuration)
>
> ```typescript
> export default defineConfig({
>   // ...
>   plugins: [
>     // ...
>     AutoImport({
>       imports: ['vue'], // 自动导入 Vue 相关函数，如：ref, reactive, toRef 等
>       resolvers: [ElementPlusResolver()], // 自动导入 ElementPlus 相关函数，如 ElMessage, ElMessageBox... (带样式)
>       eslintrc: { enabled: true } // eslint 会报 no-undef 错误，添加此项会生成 .eslintrc-auto-import.json 文件
>     }),
>     Components({
>       resolvers: [ElementPlusResolver()], // 自动导入 ElementPlus 组件，图标组件
>     }),
>   ],
> })
> ```

#### Icon 图标自动导入

使用如下命令安装 Icon 图标；参考自 [Icon 图标 | Element Plus](https://element-plus.org/zh-CN/component/icon.html#%E5%AE%89%E8%A3%85)

```
npm install @element-plus/icons-vue
```

使用 [unplugin-icons](https://github.com/antfu/unplugin-icons) 和 [unplugin-auto-import](https://github.com/antfu/unplugin-auto-import) 从 iconify 中自动导入任何图标集。使用如下命令安装 [unplugin-icons](https://github.com/antfu/unplugin-icons)

```
npm i -D unplugin-icons
```

在 `vite.config.ts` 配置文件的 `plugins` 部分增加如下配置，参考自 [此模板](https://github.com/sxzz/element-plus-best-practices/blob/db2dfc983ccda5570033a0ac608a1bd9d9a7f658/vite.config.ts#L21-L58)

```typescript
export default defineConfig({
// ...
plugins: [
    vue(),
    AutoImport({
      // 自动导入 Vue 相关函数，如：ref, reactive, toRef 等
      imports: ['vue'],
      resolvers: [
      	// 自动导入 ElementPlus 相关函数，如 ElMessage, ElMessageBox... (带样式)
        ElementPlusResolver(),
        // 自动导入图标组件
        IconsResolver()
      ],
      // eslint 会报 no-undef 错误，添加此项会生成 .eslintrc-auto-import.json 文件
      eslintrc: { enabled: true }
    }),
    Components({
      resolvers: [
        // 自动注册图标组件
        IconsResolver({
          enabledCollections: ['ep']
        }),
        // 自动导入 ElementPlus 组件
        ElementPlusResolver()
      ]
    }),
    Icons({
      autoInstall: true
    })
  ],
})
```

在 `App.vue` 文件中进行测试图标是否能自动导入，代码如下所示：

```html
<el-icon>
    <IEpUser />
</el-icon>
<el-icon>
    <i-ep-setting />
</el-icon>
<el-icon>
	<IEpView />
</el-icon>
```

可以看到图标可以正常使用！效果如下所示：<br />![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311192209992.png)

#### 布局

使用 ElementPlus 布局容器组件进行整体布局，选择 [常见布局容器 | Container 布局容器 | Element Plus](https://element-plus.org/zh-CN/component/container.html#%E5%B8%B8%E8%A7%81%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80) 中的倒数第二个；具体实现步骤如下所示：

1. 删除多余的组件，如 `HomeView`、`AboutView`、`HelloWorld`、`TheWelcome`、`WelcomeItem` 以及 `components/icons` 目录下所有的 Icon 组件；
2. 删除 `asstes` 目录下的样式文件 `base.css` 和 `main.css`，然后从 `main.ts` 文件中删除 `main.css` 的导入；
3. 删除 `App.vue` 组件中多余的代码，最终的代码如下所示：

   ```vue
   <script setup lang="ts">
   import { RouterView } from 'vue-router'
   </script>
   
   <template>
     <RouterView />
   </template>
   
   <style scoped></style>
   ```

4. 在 `components/layout` 目录下创建一个 `AppLayout` 的组件，其代码如下所示：

   ```vue
   <script lang="ts" setup></script>
   
   <template>
   	<el-container class="layout">
   		<el-aside class="aside">Aside</el-aside>
   		<el-container>
   			<el-header class="header">Header</el-header>
   			<el-main class="main">Main</el-main>
   		</el-container>
   	</el-container>
   </template>
   
   <style lang="scss" scoped>
   .layout {
   	height: 100vh;
   
   	.aside {
   		background-color: darkgray;
   		width: 200px;
   	}
   
   	.header {
   		background-color: cornflowerblue;
   	}
   
   	.main {
   		background-color: bisque;
   	}
   }
   </style>
   ```

5. 修改 `router/index.ts` 路由文件至如下所示：

   ```typescript
   import { createRouter, createWebHistory } from 'vue-router'
   import AppLayout from '@/components/layout/AppLayout.vue'
   
   const router = createRouter({
     history: createWebHistory(import.meta.env.BASE_URL),
     routes: [
       {
         path: '/',
         name: 'home',
         component: AppLayout
       }
     ]
   })
   
   export default router
   ```

6. 首先使用 `npm install -D sass` 命令安装 sass，然后在 `src/styles` 目录下创建自定义样式文件 `index.scss`，最后在 `main.ts` 文件中导入该样式文件；

   ```scss
   * {
       padding: 0;
       margin: 0;
   }
   ```

   ```typescript
   import { createApp } from 'vue'
   import { createPinia } from 'pinia'
   
   import App from './App.vue'
   import router from './router'
   
   import '@/styles/index.scss'
   
   const app = createApp(App)
   
   app.use(createPinia())
   app.use(router)
   
   app.mount('#app')
   ```

至此，最终效果如下所示：<br />![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311221048408.png)

##### 侧边栏-菜单

在 `components/layout` 目录下创建一个 `AppAside` 侧边栏组件，主要用于菜单的展示以及控制路由的跳转，其代码如下所示：

```vue
<script setup lang="ts">
const isCollapse = ref(false)
</script>

<template>
  <el-aside>
    <el-scrollbar>
      <el-menu router unique-opened :collapse="isCollapse">
        <a href="/" class="logo">
          <img src="@/assets/logo.svg" alt="logo" />
          <h1>SIMPLE</h1>
        </a>
        <el-sub-menu index="1">
          <template #title>
            <el-icon>
              <IEpSetting />
            </el-icon>
            <span>权限管理</span>
          </template>
          <el-menu-item index="/menus">
            <el-icon>
              <IEpSetting />
            </el-icon>
            <span>菜单列表</span>
          </el-menu-item>
          <el-menu-item index="/resources">
            <el-icon>
              <IEpSetting />
            </el-icon>
            <span>资源列表</span>
          </el-menu-item>
          <el-menu-item index="/roles">
            <el-icon>
              <IEpSetting />
            </el-icon>
            <span>角色列表</span>
          </el-menu-item>
        </el-sub-menu>
        <el-menu-item index="/users">
          <el-icon>
            <IEpSetting />
          </el-icon>
          <span>用户管理</span>
        </el-menu-item>
        <el-menu-item index="/courses">
          <el-icon>
            <IEpSetting />
          </el-icon>
          <span>课程管理</span>
        </el-menu-item>
        <el-sub-menu index="2">
          <template #title>
            <el-icon>
              <IEpSetting />
            </el-icon>
            <span>广告管理</span>
          </template>
          <el-menu-item index="/advertisements">
            <el-icon>
              <IEpSetting />
            </el-icon>
            <span>广告列表</span>
          </el-menu-item>
          <el-menu-item index="/advertisement-spaces">
            <el-icon>
              <IEpSetting />
            </el-icon>
            <span>广告位列表</span>
          </el-menu-item>
        </el-sub-menu>
      </el-menu>
    </el-scrollbar>
  </el-aside>
</template>
<style lang="scss" scoped>
.el-aside {
  background-color: #eee;
  height: 100vh;
  width: auto;

  .el-menu {
    background-color: #eee;
    border-right: none;

    &.el-menu--collapse {
        & span {
            display: none;
        }
    }

    .logo {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 60px;
        text-decoration: none;
        color: black;
        margin-left: 8px;
        margin-right: 8px;

        img {
            width: 32px;
            height: 32px;
        }

        span {
            margin-left: 8px;
            font-size: 18px;
            font-weight: 500;
            font-family: 'fangsong';
        }
    }
  }
}
</style>
```

在 `AppLayout` 组件中使用刚创建的 `AppAside` 侧边栏组件，代码如下所示：

```vue
<script setup lang="ts"></script>

<template>
  <div class="common-layout">
    <el-container>
      <AppAside />
      <el-container>
        <el-header>Header</el-header>
        <el-main>Main</el-main>
      </el-container>
    </el-container>
  </div>
</template>

<style lang="scss" scoped></style>
```

启动项目，效果如下所示：<br /> ![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311200115317.png)

##### 头部

### 后端环境搭建

RBAC 权限模型，如下图所示：<br />![](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202311211650330.png)

SQL 脚本如下所示：

```sql
DROP TABLE IF EXISTS `sys_menu`;
DROP TABLE IF EXISTS `sys_role`;
DROP TABLE IF EXISTS `sys_role_menu`;
DROP TABLE IF EXISTS `sys_user`;
DROP TABLE IF EXISTS `sys_user_role`;

CREATE TABLE `sys_menu`  (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '菜单id',
  `name` varchar(50) NOT NULL COMMENT '菜单名称',
  `permission` varchar(100) NOT NULL COMMENT '权限标识',
  `type` tinyint NOT NULL COMMENT '菜单类型（0-目录，1-菜单，2-按钮）',
  `sort` int NOT NULL DEFAULT 0 COMMENT '显示顺序',
  `parent_id` bigint NOT NULL DEFAULT 0 COMMENT '父菜单id',
  `path` varchar(200) NULL COMMENT '路由地址',
  `icon` varchar(100) NULL COMMENT '菜单图标',
  `component` varchar(255) NULL COMMENT '组件路径',
  `component_name` varchar(255) NULL COMMENT '组件名',
  `status` tinyint NOT NULL DEFAULT 0 COMMENT '菜单状态（0-正常，1-停用）',
  `visible` tinyint NOT NULL DEFAULT 1 COMMENT '是否可见（0-否，1-是）',
  `keep_alive` tinyint NOT NULL DEFAULT 1 COMMENT '是否缓存（0-否，1-是）',
  `always_show` tinyint NOT NULL DEFAULT 1 COMMENT '是否总是显示（0-否，1-是）',
  `creator` varchar(64) NULL COMMENT '创建者',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `updater` varchar(64) NULL COMMENT '更新者',
  `update_time` datetime NOT NULL COMMENT '更新时间',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '是否删除（0-否，1-是）',
  PRIMARY KEY (`id`)
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci COMMENT = '菜单权限表';

CREATE TABLE `sys_role`  (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '角色id',
  `name` varchar(30) NOT NULL COMMENT '角色名称',
  `code` varchar(100) NOT NULL COMMENT '角色权限字符串（如：admin）',
  `sort` int NOT NULL DEFAULT 0 COMMENT '显示顺序',
  `status` tinyint NOT NULL DEFAULT 0 COMMENT '角色状态（0-正常，1-停用）',
  `remark` varchar(500) NULL COMMENT '备注',
  `creator` varchar(64) NULL COMMENT '创建者',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `updater` varchar(64) NULL COMMENT '更新者',
  `update_time` datetime NOT NULL COMMENT '更新时间',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '是否删除（0-否，1-是）',
  PRIMARY KEY (`id`)
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci COMMENT = '角色表';

CREATE TABLE `sys_role_menu`  (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '自增编号',
  `role_id` bigint NOT NULL COMMENT '角色id',
  `menu_id` bigint NOT NULL COMMENT '菜单id',
  `creator` varchar(64) NULL COMMENT '创建者',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `updater` varchar(64) NULL COMMENT '更新者',
  `update_time` datetime NOT NULL COMMENT '更新时间',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '是否删除（0-否，1-是）',
  PRIMARY KEY (`id`)
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci COMMENT = '角色和菜单关联表';

CREATE TABLE `sys_user`  (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '用户id',
  `username` varchar(30) NOT NULL COMMENT '用户账号',
  `nickname` varchar(30) NOT NULL COMMENT '用户昵称',
  `password` varchar(100) NOT NULL COMMENT '密码',
  `phone` varchar(11) NULL COMMENT '手机号码',
  `email` varchar(50) NULL COMMENT '用户邮箱',
  `gender` tinyint NOT NULL DEFAULT 0 COMMENT '用户性别（0-男，1-女，2-未知）',
  `avatar` varchar(512) NULL COMMENT '头像地址',
  `status` tinyint NOT NULL DEFAULT 0 COMMENT '账号状态（0-正常，1-停用）',
  `locked` tinyint NOT NULL DEFAULT 0 COMMENT '是否锁定（0-否，1-是）',
  `creator` varchar(64) NULL COMMENT '创建者',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `updater` varchar(64) NULL COMMENT '更新者',
  `update_time` datetime NOT NULL COMMENT '更新时间',
  `remark` varchar(500) NULL COMMENT '备注',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '是否删除（0-否，1-是）',
  PRIMARY KEY (`id`),
  UNIQUE INDEX `idx_username`(`username` ASC) USING BTREE
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci COMMENT = '用户表';

CREATE TABLE `sys_user_role`  (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '自增编号',
  `user_id` bigint NOT NULL COMMENT '用户id',
  `role_id` bigint NOT NULL COMMENT '角色id',
  `creator` varchar(64) NULL COMMENT '创建者',
  `create_time` datetime NULL COMMENT '创建时间',
  `updater` varchar(64) NULL COMMENT '更新者',
  `update_time` datetime NULL COMMENT '更新时间',
  `deleted` tinyint NOT NULL DEFAULT 0 COMMENT '是否删除（0-否，1-是）',
  PRIMARY KEY (`id`)
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci COMMENT = '用户和角色关联表';
```
